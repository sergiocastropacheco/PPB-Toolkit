<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Basics of Data Visualisation | A Participatory Plant Breeding Toolkit in R and RStudio</title>
  <meta name="description" content="Chapter 4 Basics of Data Visualisation | A Participatory Plant Breeding Toolkit in R and RStudio" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Basics of Data Visualisation | A Participatory Plant Breeding Toolkit in R and RStudio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Basics of Data Visualisation | A Participatory Plant Breeding Toolkit in R and RStudio" />
  
  
  

<meta name="author" content="By Sergio Castro and Matteo Petitti" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling-and-summarizing.html"/>
<link rel="next" href="experimental-design.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Participatory Plant Breeding Toolkit in R and RStudio</a></li> 
<img src="logo.png" width="100" height="70" style="position:center">

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html"><i class="fa fa-check"></i><b>2</b> First Steps in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#preparing-and-reading-your-data"><i class="fa fa-check"></i><b>2.2</b> Preparing and reading your data</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-data-manipulation"><i class="fa fa-check"></i><b>2.3</b> Basic data manipulation</a></li>
<li class="chapter" data-level="2.4" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-statistics-and-plots"><i class="fa fa-check"></i><b>2.4</b> Basic Statistics and Plots</a></li>
<li class="chapter" data-level="2.5" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#packages-in-r."><i class="fa fa-check"></i><b>2.5</b> Packages in R.</a></li>
<li class="chapter" data-level="2.6" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#final-considerations"><i class="fa fa-check"></i><b>2.6</b> Final considerations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling and Summarizing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#basic-r"><i class="fa fa-check"></i><b>3.1</b> Basic R</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#dplyr"><i class="fa fa-check"></i><b>3.2</b> dplyr</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#metan"><i class="fa fa-check"></i><b>3.3</b> metan</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Basics of Data Visualisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#base-package"><i class="fa fa-check"></i><b>4.1</b> Base package</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#plot-vs.-index"><i class="fa fa-check"></i><b>4.1.1</b> Plot vs. Index</a></li>
<li class="chapter" data-level="4.1.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plot"><i class="fa fa-check"></i><b>4.1.2</b> Scatter plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#histogram"><i class="fa fa-check"></i><b>4.1.3</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#ggplot"><i class="fa fa-check"></i><b>4.2</b> ggplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#box-plot"><i class="fa fa-check"></i><b>4.2.1</b> Box Plot</a></li>
<li class="chapter" data-level="4.2.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plots"><i class="fa fa-check"></i><b>4.2.2</b> Scatter plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#bar-plots"><i class="fa fa-check"></i><b>4.2.3</b> Bar plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#exporting-plots"><i class="fa fa-check"></i><b>4.3</b> Exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>5</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="5.1" data-path="experimental-design.html"><a href="experimental-design.html#digger"><i class="fa fa-check"></i><b>5.1</b> DiGGer</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>5.1.1</b> Randomized Complete Block Design!</a></li>
<li class="chapter" data-level="5.1.2" data-path="experimental-design.html"><a href="experimental-design.html#incomplete-block-design-ibd"><i class="fa fa-check"></i><b>5.1.2</b> Incomplete Block Design (IBD)</a></li>
<li class="chapter" data-level="5.1.3" data-path="experimental-design.html"><a href="experimental-design.html#partially-replicated-block-design"><i class="fa fa-check"></i><b>5.1.3</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="experimental-design.html"><a href="experimental-design.html#agricolae"><i class="fa fa-check"></i><b>5.2</b> Agricolae</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>5.2.1</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="5.2.2" data-path="experimental-design.html"><a href="experimental-design.html#partially-replicated-block-design-1"><i class="fa fa-check"></i><b>5.2.2</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="experimental-design.html"><a href="experimental-design.html#organic-trials"><i class="fa fa-check"></i><b>5.3</b> Organic Trials</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>6</b> Statistical tests</a></li>
<li class="chapter" data-level="7" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>7</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-analysis.html"><a href="spatial-analysis.html#spats"><i class="fa fa-check"></i><b>7.1</b> SpATS</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="gge-biplots.html"><a href="gge-biplots.html"><i class="fa fa-check"></i><b>8</b> GGE BiPlots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="gge-biplots.html"><a href="gge-biplots.html#metan-1"><i class="fa fa-check"></i><b>8.1</b> metan</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="gge-biplots.html"><a href="gge-biplots.html#which-won-where"><i class="fa fa-check"></i><b>8.1.1</b> Which won where</a></li>
<li class="chapter" data-level="8.1.2" data-path="gge-biplots.html"><a href="gge-biplots.html#mean-vs.-stability"><i class="fa fa-check"></i><b>8.1.2</b> Mean vs. Stability</a></li>
<li class="chapter" data-level="8.1.3" data-path="gge-biplots.html"><a href="gge-biplots.html#genotype-ranking"><i class="fa fa-check"></i><b>8.1.3</b> Genotype Ranking</a></li>
<li class="chapter" data-level="8.1.4" data-path="gge-biplots.html"><a href="gge-biplots.html#genotype-comparison"><i class="fa fa-check"></i><b>8.1.4</b> Genotype Comparison</a></li>
<li class="chapter" data-level="8.1.5" data-path="gge-biplots.html"><a href="gge-biplots.html#modifying-the-plot."><i class="fa fa-check"></i><b>8.1.5</b> Modifying the plot.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Participatory Plant Breeding Toolkit in R and RStudio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basics-of-data-visualisation" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Basics of Data Visualisation</h1>
<style>
body {
text-align: justify}
</style>
<p><img src="rsrstrip.png" /></p>
<p>Data visualization is, in our opinion, a remarkably important part of data analysis. Data visualization can be exploratory or explanatory. In the first case, it could allow us to check if the data has errors, or if there are any trends that we would like to explore further. In the second case, it would allow us to communicate and publish our results to other, in a way to evidenciate what our data are trying to say. Of course, for the second case, plots should usually come along with the adequate <a href="statistical-tests.html#statistical-tests">statistical tests</a> for the matter.</p>
<p>Trough this chapter, we will see the very basics of data visualization with two of the most used packages in R, which are the <strong>Base Package and ggplot</strong>.</p>
<p><img src="rsrstrip.png" /></p>
<div id="base-package" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Base package</h2>
<p>This is the package that comes with R. It is maybe the easiest package to use, but it is less flexible. Some basic functions are:</p>
<ul>
<li>plot()</li>
<li>hist()</li>
<li>barplot()</li>
<li>boxplot()</li>
</ul>
<p><img src="rsrstrip.png" /></p>
<div id="plot-vs.-index" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Plot vs. Index</h3>
<p>If we use the most basic of functions, <strong>plot() </strong>, and we only indicate one variable, the other axis will be automatically assigned to an “index” value. This means that data will be plotted as they appear in the data frame.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="basics-of-data-visualisation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First we upload our data</span></span>
<span id="cb1-2"><a href="basics-of-data-visualisation.html#cb1-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;tomatoMLT2020.csv&quot;</span>)</span>
<span id="cb1-3"><a href="basics-of-data-visualisation.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="basics-of-data-visualisation.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#The we fill the plot function with only one argument</span></span>
<span id="cb1-5"><a href="basics-of-data-visualisation.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydata<span class="sc">$</span>yield)</span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>This could be useful to know if, in a given section of the data frame, the observations are notably different than the rest. In this case, because data are arranged by environment, this area of high points in the center indicate the presence of a very productive environment.</p>
<p><img src="rsrstrip.png" /></p>
</div>
<div id="scatter-plot" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Scatter plot</h3>
<p>This is a kind of plot you can use if you have two quantitative variables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="basics-of-data-visualisation.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="at">x=</span> mydata<span class="sc">$</span>yield,                 <span class="co"># The x axis is the total yield.</span></span>
<span id="cb2-2"><a href="basics-of-data-visualisation.html#cb2-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span> mydata<span class="sc">$</span>farmers_eval)          <span class="co"># The y axis is the farmer&#39;s evaluation.</span></span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p><img src="rsrstrip.png" /></p>
</div>
<div id="histogram" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Histogram</h3>
<p>Histograms are very useful to understand the distribution of the data In this case, we use the variable of the farmer’s evaluation, set in a scale from 1 to 5. Normally, for most quantitative biological data, we could expect a <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="basics-of-data-visualisation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mydata<span class="sc">$</span>farmers_eval)</span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>On the same histogram, we could do further elaborations to make it look better. We could add a main title, labels for the axes, define the number of breaks or columns, and select the name of the color, from this <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">list</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="basics-of-data-visualisation.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span> mydata<span class="sc">$</span>farmers_eval,                                                   <span class="co">#Variable to plot</span></span>
<span id="cb4-2"><a href="basics-of-data-visualisation.html#cb4-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span> <span class="st">&quot;Histogram for Farmer&#39;s Evaluation in Tomato PPB trials&quot;</span>,    <span class="co">#Main Title</span></span>
<span id="cb4-3"><a href="basics-of-data-visualisation.html#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span> <span class="st">&quot;Evaluation&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Frequency&quot;</span>,                             <span class="co">#Axis titles</span></span>
<span id="cb4-4"><a href="basics-of-data-visualisation.html#cb4-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span> <span class="dv">12</span>,                                                        <span class="co">#How many breaks or columns       </span></span>
<span id="cb4-5"><a href="basics-of-data-visualisation.html#cb4-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span> <span class="st">&quot;coral&quot;</span>)   <span class="co">#Color</span></span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Elements can be added after a plot was called. For example, in this case, we can add a vertical line to the plot, and we could position that line exactly in the mean value for yield.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="basics-of-data-visualisation.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span> mydata<span class="sc">$</span>farmers_eval,                                                   </span>
<span id="cb5-2"><a href="basics-of-data-visualisation.html#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span> <span class="st">&quot;Histogram for Farmer&#39;s Evaluation in Tomato PPB trials&quot;</span>,    </span>
<span id="cb5-3"><a href="basics-of-data-visualisation.html#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span> <span class="st">&quot;Evaluation&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Frequency&quot;</span>,                             </span>
<span id="cb5-4"><a href="basics-of-data-visualisation.html#cb5-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span> <span class="dv">12</span>,                                                        </span>
<span id="cb5-5"><a href="basics-of-data-visualisation.html#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span> <span class="st">&quot;coral&quot;</span>)                                   </span>
<span id="cb5-6"><a href="basics-of-data-visualisation.html#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">v=</span> <span class="fu">mean</span>(mydata<span class="sc">$</span>farmers_eval),     <span class="co"># Vertical line set at the mean value</span></span>
<span id="cb5-7"><a href="basics-of-data-visualisation.html#cb5-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,                    <span class="co"># Line color</span></span>
<span id="cb5-8"><a href="basics-of-data-visualisation.html#cb5-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span> <span class="dv">4</span>)                                <span class="co"># Line width</span></span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><img src="rsrstrip.png" /></p>
<p><strong>Box plot</strong></p>
<p>Another useful way to plot information is through a <a href="https://en.wikipedia.org/wiki/Box_plot">boxplot</a> which not only presents the mean values, but also the quartile distribution. It would be useful, for example to compare the overall yields of the different varieties (or in the different environments). However, for this kind of plot to work, we need at least one of the variables to be a factor. We can check the variable types with the <strong>str() </strong> function, and see that both the variety and the location are interpreted as characters</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="basics-of-data-visualisation.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydata)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    112 obs. of  11 variables:
##  $ location         : chr  &quot;Molise&quot; &quot;Molise&quot; &quot;Molise&quot; &quot;Molise&quot; ...
##  $ plot             : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ rep              : int  1 1 2 2 1 1 2 2 1 1 ...
##  $ row              : int  1 2 3 4 1 2 3 4 1 2 ...
##  $ col              : int  1 1 1 1 2 2 2 2 3 3 ...
##  $ variety          : chr  &quot;Var. A&quot; &quot;Var. D&quot; &quot;Var. I&quot; &quot;Var. N&quot; ...
##  $ farmers_eval     : num  3.24 2.71 3.35 3.24 3.24 3.06 2.88 3.24 2.94 2.88 ...
##  $ yield            : num  789 498 822 846 1083 ...
##  $ yield_first      : num  11 0 24.9 46.8 28.2 ...
##  $ perc_mark_yield  : num  57.5 55.8 76 55.3 81.2 ...
##  $ mean_fruit_weight: num  17.43 7.37 35.54 14.19 68.85 ...</code></pre>
<p>We can change that easily with the <strong>as.factor() </strong> function. What we do is that replace the actual column we have, with the same column interpreted as a factor.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="basics-of-data-visualisation.html#cb8-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>variety <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mydata<span class="sc">$</span>variety)</span>
<span id="cb8-2"><a href="basics-of-data-visualisation.html#cb8-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>location <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mydata<span class="sc">$</span>location)</span></code></pre></div>
<p>Now we can do the boxplot. By using the function <strong>plot() </strong> with a quantitative and a factor variable, a boxplot is automatically generated</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="basics-of-data-visualisation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span> mydata<span class="sc">$</span>location,         </span>
<span id="cb9-2"><a href="basics-of-data-visualisation.html#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span> mydata<span class="sc">$</span>yield,           </span>
<span id="cb9-3"><a href="basics-of-data-visualisation.html#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">&quot;Yield (kg)&quot;</span>,        </span>
<span id="cb9-4"><a href="basics-of-data-visualisation.html#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Location&quot;</span>)         </span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-8-1.png" width="150%" /></p>
<p><img src="rsrstrip.png" /></p>
</div>
</div>
<div id="ggplot" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> ggplot</h2>
<p>ggplot is one of the most used and versatile packages to do graphics in R. ‘gg’ stands for “grammar of graphics,” and it is based on a modular system that allows you to build your plots feature by feature. It can be easily installed with <strong>install.packages() </strong> (only once) and called with <strong>library() </strong> (every time that you open an R Session).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="basics-of-data-visualisation.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb10-2"><a href="basics-of-data-visualisation.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>The most important thing in ggplot is that every feature should be included as a layer. The main function is <strong>ggplot() </strong>, and the main arguments are the data frame that you are using, and <strong>aes() </strong>, that stands for aestithics and lets you choose the parameters for the graph. We could do one first try.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="basics-of-data-visualisation.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata,   <span class="co"># my data frame</span></span>
<span id="cb11-2"><a href="basics-of-data-visualisation.html#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>variety,      <span class="co"># my x axis</span></span>
<span id="cb11-3"><a href="basics-of-data-visualisation.html#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>yield))   <span class="co"># my y axis and the (very important) closure of parenthesis</span></span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We have created the plot and it’s coordinates, but we have not assigned any ‘geometrical’ object yet. At this point, we could add bars, points, lines, boxes, etc. We will see how to do that next.</p>
<p><img src="rsrstrip.png" /></p>
<div id="box-plot" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Box Plot</h3>
<p>For a box plot, we write the same code and add the function <strong>geom_boxplot() </strong>, which can be empty of arguments, as the indispensable ones have already been declared. However, because I want my boxes to be gray, I can specify it as an argument.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="basics-of-data-visualisation.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata, <span class="fu">aes</span>(<span class="at">x=</span>variety, <span class="at">y=</span>yield))<span class="sc">+</span></span>
<span id="cb12-2"><a href="basics-of-data-visualisation.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-12-1.png" width="672" />
On top of the boxes, I could choose to plot every individual observation with a point, and, if I wish too, I could color those points according to the corresponding location. Notice that now, the color argument is inside an <strong>aes() </strong> function, because we are not assigning an arbitrary color for all points, but rather making them vary according to a parameter present in the data frame.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="basics-of-data-visualisation.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata,  <span class="fu">aes</span>(<span class="at">x=</span>variety,<span class="at">y=</span>yield))<span class="sc">+</span> </span>
<span id="cb13-2"><a href="basics-of-data-visualisation.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb13-3"><a href="basics-of-data-visualisation.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> location)) </span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-13-1.png" width="150%" /></p>
<p>Overall, there is a large deal of different geometries that can be used, alone or in combinations, to represent data in many ways. In that case, a very handy ressource for geometries in ggplot is the specially designed <a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf">Cheat Sheet</a> that they offer.</p>
<p>Finally, if you find it akward, or too bulky two have all the information from all the locations in one plot. You could easily make a small subplot, ie. a ‘facet,’ for every location. Both functions <strong>facet_wrap() </strong> and <strong>facet_grid() </strong> can do this in slightly different ways. If we do this, it is convenient to remove the points colored by location. The plot would look like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="basics-of-data-visualisation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata,  <span class="fu">aes</span>(<span class="at">x=</span>variety,<span class="at">y=</span>yield))<span class="sc">+</span> </span>
<span id="cb14-2"><a href="basics-of-data-visualisation.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb14-3"><a href="basics-of-data-visualisation.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(location<span class="sc">~</span>., <span class="co"># I choose to plot my locations, </span></span>
<span id="cb14-4"><a href="basics-of-data-visualisation.html#cb14-4" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># the &quot;~&quot; sign means allows me introduce another variable to </span></span>
<span id="cb14-5"><a href="basics-of-data-visualisation.html#cb14-5" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># to subdivide the plots, but I choose none so we just write &quot;.&quot;</span></span>
<span id="cb14-6"><a href="basics-of-data-visualisation.html#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span><span class="dv">1</span>,</span>
<span id="cb14-7"><a href="basics-of-data-visualisation.html#cb14-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span> <span class="st">&#39;free&#39;</span>)    <span class="co"># Additionally, we want all the subplots the be drawn in only one column</span></span></code></pre></div>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-14-1.png" width="150%" /></p>
<p><img src="rsrstrip.png" /></p>
</div>
<div id="scatter-plots" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Scatter plots</h3>
<p>If I choose to plot two quantitative variables against one another, and choose the <strong>geom_point() </strong> for each each point, a very useful scatter plot will come out. What is more, I could add a fitted line according to a linear model (or one of other models available).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="basics-of-data-visualisation.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata, <span class="fu">aes</span>(<span class="at">y=</span>farmers_eval ,  <span class="at">x=</span>yield))<span class="sc">+</span></span>
<span id="cb15-2"><a href="basics-of-data-visualisation.html#cb15-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb15-3"><a href="basics-of-data-visualisation.html#cb15-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_smooth</span>(<span class="at">method=</span> lm) <span class="co">#Regression line with Linear Method (lm)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>To this point, some evident effect of correlation can be seen between the yield and the farmer’s evaluation. But we see clearly a cloud of points in the upper right, which correspond normally to our highest yielding location. We could, for example, divide environments with <strong>facet_wrap() </strong> and add a small label to each point trough <strong>geom_text() </strong> or <strong>geom_label</strong> , indicating the corresponding variety</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="basics-of-data-visualisation.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata, <span class="fu">aes</span>(<span class="at">y=</span>farmers_eval ,  <span class="at">x=</span>yield))<span class="sc">+</span></span>
<span id="cb17-2"><a href="basics-of-data-visualisation.html#cb17-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb17-3"><a href="basics-of-data-visualisation.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_smooth</span>(<span class="at">method=</span> lm)<span class="sc">+</span>           </span>
<span id="cb17-4"><a href="basics-of-data-visualisation.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">facet_wrap</span>(location<span class="sc">~</span>., <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">scales=</span> <span class="st">&#39;free&#39;</span>)<span class="sc">+</span></span>
<span id="cb17-5"><a href="basics-of-data-visualisation.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> variety),    <span class="co"># we define the variety as the parameter</span></span>
<span id="cb17-6"><a href="basics-of-data-visualisation.html#cb17-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size=</span> <span class="dv">2</span>,</span>
<span id="cb17-7"><a href="basics-of-data-visualisation.html#cb17-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nudge_y =</span><span class="fl">0.1</span> )                  <span class="co"># and we put the small so that they don&#39;t overlap </span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>plot.cor.stats &lt;-plot.cor + stat_cor(label.y= 4) # L’argumento label.y ci da la posizione del testo
plot.cor.stats</p>
<p><img src="rsrstrip.png" /></p>
</div>
<div id="bar-plots" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Bar plots</h3>
<p>This section is under progress!</p>
<p><img src="rsrstrip.png" /></p>
</div>
</div>
<div id="exporting-plots" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Exporting plots</h2>
<p>There are mainly two ways to export a package: by clicking manually or through R code.</p>
<ul>
<li><p>By clicking manually.</p>
<ul>
<li>Once you created your plot and you see it on the lower left panel, you can click on “Export,” then select your desired parameters, and save it on your WD (or elsewhere).</li>
</ul></li>
<li><p>By code</p>
<ul>
<li>If you want to be more automatic, you can use code to export and save your image. The functions <strong>png()</strong> of <strong>jpg()</strong> can help you in this sense. To do this, you have to assign a create your ggplot, and then run your prefered function, specifying the output name and dimensions. At the end it’s important to use <strong>dev.off()</strong> to indicate that your “export device” has been closed.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="basics-of-data-visualisation.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> mydata, <span class="fu">aes</span>(<span class="at">y=</span>farmers_eval ,  <span class="at">x=</span>yield))<span class="sc">+</span></span>
<span id="cb19-2"><a href="basics-of-data-visualisation.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb19-3"><a href="basics-of-data-visualisation.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">geom_smooth</span>(<span class="at">method=</span> lm) <span class="co">#Regression line with Linear Method (lm)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="PPB-Toolkit-for-R-and-R-Studio_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="basics-of-data-visualisation.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;myplot.png&quot;</span>, <span class="at">width=</span> <span class="dv">300</span>, <span class="at">height=</span> <span class="dv">300</span>)</span>
<span id="cb21-2"><a href="basics-of-data-visualisation.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<p><img src="rsrstrip.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling-and-summarizing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="experimental-design.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PPB Toolkit for R and R Studio.pdf", "PPB Toolkit for R and R Studio.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
