<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Wrangling and Summarizing | A PPB Toolkit in RStudio</title>
  <meta name="description" content="This is just a test." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Wrangling and Summarizing | A PPB Toolkit in RStudio" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is just a test." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Wrangling and Summarizing | A PPB Toolkit in RStudio" />
  
  <meta name="twitter:description" content="This is just a test." />
  

<meta name="author" content="Sergio Castro and Matteo Petitti" />


<meta name="date" content="2021-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="first-steps-in-r.html"/>
<link rel="next" href="basics-of-data-visualisation.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A PPB Toolkit in R and RStudio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Description</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html"><i class="fa fa-check"></i><b>3</b> First Steps in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#preparing-and-reading-your-data"><i class="fa fa-check"></i><b>3.2</b> Preparing and reading your data</a></li>
<li class="chapter" data-level="3.3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-data-manipulation"><i class="fa fa-check"></i><b>3.3</b> Basic data manipulation</a></li>
<li class="chapter" data-level="3.4" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-statistics-and-plots"><i class="fa fa-check"></i><b>3.4</b> Basic Statistics and Plots</a></li>
<li class="chapter" data-level="3.5" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#packages-in-r."><i class="fa fa-check"></i><b>3.5</b> Packages in R.</a></li>
<li class="chapter" data-level="3.6" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#final-considerations"><i class="fa fa-check"></i><b>3.6</b> Final considerations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling and Summarizing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#dplyr"><i class="fa fa-check"></i><b>4.1</b> dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html"><i class="fa fa-check"></i><b>5</b> Basics of Data Visualisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#base-package"><i class="fa fa-check"></i><b>5.1</b> Base package</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#plot-vs.-index"><i class="fa fa-check"></i><b>5.1.1</b> Plot vs. Index</a></li>
<li class="chapter" data-level="5.1.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plot"><i class="fa fa-check"></i><b>5.1.2</b> Scatter plot</a></li>
<li class="chapter" data-level="5.1.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#histogram"><i class="fa fa-check"></i><b>5.1.3</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#ggplot"><i class="fa fa-check"></i><b>5.2</b> ggplot</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#box-plot"><i class="fa fa-check"></i><b>5.2.1</b> Box Plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plots"><i class="fa fa-check"></i><b>5.2.2</b> Scatter plots</a></li>
<li class="chapter" data-level="5.2.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#bar-plots"><i class="fa fa-check"></i><b>5.2.3</b> Bar plots</a></li>
<li class="chapter" data-level="5.2.4" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#adjusting-details"><i class="fa fa-check"></i><b>5.2.4</b> Adjusting details</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#exporting-plots"><i class="fa fa-check"></i><b>5.3</b> Exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html"><i class="fa fa-check"></i><b>6</b> Experimental Design and Field Preparation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#digger"><i class="fa fa-check"></i><b>6.1</b> DiGGer</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>6.1.1</b> Randomized Complete Block Design!</a></li>
<li class="chapter" data-level="6.1.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#incomplete-block-design-ibd"><i class="fa fa-check"></i><b>6.1.2</b> Incomplete Block Design (IBD)</a></li>
<li class="chapter" data-level="6.1.3" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#partially-replicated-block-design"><i class="fa fa-check"></i><b>6.1.3</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#agricolae"><i class="fa fa-check"></i><b>6.2</b> Agricolae</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>6.2.1</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="6.2.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#partially-replicated-block-design-1"><i class="fa fa-check"></i><b>6.2.2</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#organic-trials"><i class="fa fa-check"></i><b>6.3</b> Organic Trials</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical tests</a></li>
<li class="chapter" data-level="8" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>8</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-analysis.html"><a href="spatial-analysis.html#spats"><i class="fa fa-check"></i><b>8.1</b> SpATS</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gge-biplots.html"><a href="gge-biplots.html"><i class="fa fa-check"></i><b>9</b> GGE Biplots</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A PPB Toolkit in RStudio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-and-summarizing" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Wrangling and Summarizing</h1>
<p>Data wrangling is one of the most important activites that you can do in R. It allows you to, sistematically, take a given data frame (or several) and set them into the format that works best for the analysis. In the last chaper, we saw already some of the most basic elements of data wrangling (like creating a new column from two other). Now, we will see a brief summary of what can be done with dplyr, a package specifically designed for that purpose.</p>
<div id="dplyr" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> dplyr</h2>
<p>‘dplyr’ is a package developed by the R Core Team developers, and gives us “an easy and intuitive grammatic for data manipulation.” We first have to install it (only once) and call it (every time you open R).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-wrangling-and-summarizing.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb1-2"><a href="data-wrangling-and-summarizing.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>Some of the most useful functions in dplyr R are</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-wrangling-and-summarizing.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>() <span class="co"># To filter rows according to criteria</span></span>
<span id="cb2-2"><a href="data-wrangling-and-summarizing.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>() <span class="co"># TO select only certain columns</span></span>
<span id="cb2-3"><a href="data-wrangling-and-summarizing.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>() <span class="co"># To rename columns. </span></span>
<span id="cb2-4"><a href="data-wrangling-and-summarizing.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>() <span class="co"># TO create a new column from an old one.</span></span></code></pre></div>
<p>For example, you can create a new dataframe that contains a reduced set of variables.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-wrangling-and-summarizing.html#cb3-1" aria-hidden="true" tabindex="-1"></a>newdataframe <span class="ot">&lt;-</span> <span class="fu">select</span>(mydata, location, variety, yield, farmers_eval, mean_fruit_weight)</span></code></pre></div>
<p>Within this new data frame, you can create a new column, which converts mean fruit weight (now in kg) to grams (g), through the function “mutate.”</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-wrangling-and-summarizing.html#cb4-1" aria-hidden="true" tabindex="-1"></a>newdataframe2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newdataframe, <span class="at">meanfruitweight_grams =</span> mean_fruit_weight <span class="sc">*</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><strong>The pipeline %&gt;% operator.</strong></p>
<p>With the pipeline operator you can chain more than one operation together, instead of using temporary objects and changing them. It also allows to call my first object (‘mydata’) only once</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-wrangling-and-summarizing.html#cb5-1" aria-hidden="true" tabindex="-1"></a>newdataframe3 <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="data-wrangling-and-summarizing.html#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">select</span>(location, variety, rep, mean_fruit_weight) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="data-wrangling-and-summarizing.html#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>( <span class="at">meanfruitweight_grams =</span> mean_fruit_weight <span class="sc">*</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><strong>Aggregate data</strong></p>
<p>Finally, dplyr helps us us to calculate, for example, the mean perfomance of each variety per environment, given that there are two reps.</p>
<p>For this, you have to use the group_by() and summarize (). Under group_by, we put the aggrupating facors. Under summarize, we put the columns we want, in this case, we want the means and the standard deviations
.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-wrangling-and-summarizing.html#cb6-1" aria-hidden="true" tabindex="-1"></a>mydata_means <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span>                   <span class="co">#Our initial object</span></span>
<span id="cb6-2"><a href="data-wrangling-and-summarizing.html#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(variety, location) <span class="sc">%&gt;%</span>         <span class="co">#Groupped by variety and location</span></span>
<span id="cb6-3"><a href="data-wrangling-and-summarizing.html#cb6-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarize</span>(<span class="fu">mean</span>(farmers_eval),           <span class="co">#Mean of farmer&#39;s evaluation</span></span>
<span id="cb6-4"><a href="data-wrangling-and-summarizing.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sd</span>(farmers_eval),           <span class="co">#SD of farmer&#39;s evaluation</span></span>
<span id="cb6-5"><a href="data-wrangling-and-summarizing.html#cb6-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mean</span>(yield),                <span class="co">#Mean of yield</span></span>
<span id="cb6-6"><a href="data-wrangling-and-summarizing.html#cb6-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">sd</span>(yield))                   <span class="co">#SD of yield</span></span></code></pre></div>
<p><strong>Save your data</strong></p>
<p>Once you have created and modified and object, you can save it on the same folder in a .csv format.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-wrangling-and-summarizing.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(mydata_means, <span class="st">&quot;tomatodata_means.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="first-steps-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basics-of-data-visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PPB Toolkit.pdf", "PPB Toolkit.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
