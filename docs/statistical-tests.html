<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Statistical tests | A PPB Toolkit in RStudio</title>
  <meta name="description" content="Chapter 7 Statistical tests | A PPB Toolkit in RStudio" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Statistical tests | A PPB Toolkit in RStudio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Statistical tests | A PPB Toolkit in RStudio" />
  
  
  

<meta name="author" content="Sergio Castro and Matteo Petitti" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="experimental-design-and-field-preparation.html"/>
<link rel="next" href="spatial-analysis.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A PPB Toolkit in R and RStudio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html"><i class="fa fa-check"></i><b>3</b> First Steps in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#preparing-and-reading-your-data"><i class="fa fa-check"></i><b>3.2</b> Preparing and reading your data</a></li>
<li class="chapter" data-level="3.3" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-data-manipulation"><i class="fa fa-check"></i><b>3.3</b> Basic data manipulation</a></li>
<li class="chapter" data-level="3.4" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#basic-statistics-and-plots"><i class="fa fa-check"></i><b>3.4</b> Basic Statistics and Plots</a></li>
<li class="chapter" data-level="3.5" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#packages-in-r."><i class="fa fa-check"></i><b>3.5</b> Packages in R.</a></li>
<li class="chapter" data-level="3.6" data-path="first-steps-in-r.html"><a href="first-steps-in-r.html#final-considerations"><i class="fa fa-check"></i><b>3.6</b> Final considerations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling and Summarizing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-and-summarizing.html"><a href="data-wrangling-and-summarizing.html#dplyr"><i class="fa fa-check"></i><b>4.1</b> dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html"><i class="fa fa-check"></i><b>5</b> Basics of Data Visualisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#base-package"><i class="fa fa-check"></i><b>5.1</b> Base package</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#plot-vs.-index"><i class="fa fa-check"></i><b>5.1.1</b> Plot vs. Index</a></li>
<li class="chapter" data-level="5.1.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plot"><i class="fa fa-check"></i><b>5.1.2</b> Scatter plot</a></li>
<li class="chapter" data-level="5.1.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#histogram"><i class="fa fa-check"></i><b>5.1.3</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#ggplot"><i class="fa fa-check"></i><b>5.2</b> ggplot</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#box-plot"><i class="fa fa-check"></i><b>5.2.1</b> Box Plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#scatter-plots"><i class="fa fa-check"></i><b>5.2.2</b> Scatter plots</a></li>
<li class="chapter" data-level="5.2.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#bar-plots"><i class="fa fa-check"></i><b>5.2.3</b> Bar plots</a></li>
<li class="chapter" data-level="5.2.4" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#adjusting-details"><i class="fa fa-check"></i><b>5.2.4</b> Adjusting details</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="basics-of-data-visualisation.html"><a href="basics-of-data-visualisation.html#exporting-plots"><i class="fa fa-check"></i><b>5.3</b> Exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html"><i class="fa fa-check"></i><b>6</b> Experimental Design and Field Preparation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#digger"><i class="fa fa-check"></i><b>6.1</b> DiGGer</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>6.1.1</b> Randomized Complete Block Design!</a></li>
<li class="chapter" data-level="6.1.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#incomplete-block-design-ibd"><i class="fa fa-check"></i><b>6.1.2</b> Incomplete Block Design (IBD)</a></li>
<li class="chapter" data-level="6.1.3" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#partially-replicated-block-design"><i class="fa fa-check"></i><b>6.1.3</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#agricolae"><i class="fa fa-check"></i><b>6.2</b> Agricolae</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>6.2.1</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="6.2.2" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#partially-replicated-block-design-1"><i class="fa fa-check"></i><b>6.2.2</b> Partially Replicated Block Design</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="experimental-design-and-field-preparation.html"><a href="experimental-design-and-field-preparation.html#organic-trials"><i class="fa fa-check"></i><b>6.3</b> Organic Trials</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical tests</a></li>
<li class="chapter" data-level="8" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>8</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-analysis.html"><a href="spatial-analysis.html#spats"><i class="fa fa-check"></i><b>8.1</b> SpATS</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gge-biplots.html"><a href="gge-biplots.html"><i class="fa fa-check"></i><b>9</b> GGE Biplots</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A PPB Toolkit in RStudio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-tests" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Statistical tests</h1>
<p>#Andiamo vedere tre!</p>
<p><em>1. Normalita (con Grafichi e Shapiro Wilks)
</em>2. ANOVA
*3. LSD o HSD</p>
<p>#Normalita</p>
<p>#DOMANDA! Cos’e la normalita?</p>
<p>#TUTTI I AMBIENTI!
ggplot(mydata, aes(x=yield))+ # Plot general
geom_histogram(colour=“black”)+ # Istogramma
labs(y= “Frequenzia,” x = “Resa (kg)”)+ #Labels
theme(text= element_text(size=15)) # Font size</p>
<p>#Non e molto normale. Andiamo vedere cosa c’eper ambiente!</p>
<p>#E per questo e utile il facet_wrap</p>
<p>ggplot(mydata, aes(x=yield)) + # Plot general
geom_histogram(colour=“black,” fill=“white”)+ # Istogramma
labs(y= “Frequency,” x = “Resa”)+ # Etichette
facet_wrap(mydata$loc ~ .) + # Fare un plot per localita
theme(text= element_text(size=15)) # Font size</p>
<p>E chiaro que Molise e Sestola sono abastanza normali.
E che in Rotonda e Castronuovo si sono outliers que ci lasciano essere normalli.</p>
<p>#—————————————————-#</p>
<p>Normalita con test —-
Il test piu usato e Shapiro-Wilks</p>
<p># Ipotessi nula -&gt; i dati sono normali -&gt; p &gt; 0.05
# Ipotessi alternativa -&gt; i dati non sono normali -&gt; p &lt; 0.05</p>
<p>shapiro.test(mydata$yield)
?shapiro.test
# Anormalisime! Confirmiamo quello
# que abbiamo guardato nel plot
# Quindi, non devo usare l’ANOVA in questo caso.</p>
<p>#Ma, si vediamo ogni ambiente, la cosa cambia.
#Per fare quello, una opzione sarebbe fare subsets
# e poi usare il test in ogni subset.</p>
<p>#Ma c’e un’altra opzione
#Questo paccheto ci permette fare
#il test Shapiro per fattore!!
install.packages(“RVAideMemoire”)
library(RVAideMemoire)</p>
<p>#Dai
byf.shapiro(yield ~ loc, mydata)</p>
<p>castronuovo = subset(mydata, loc == “Castronuovo”)
shapiro.test(castronuovo$yield)</p>
<p>#Un ambiente non e normali! Ed il resto si!<br />
#Inoltre, la diferenzia tra 0,047 e 0,05 e molto bassa.
#Nel grafico vediamo que il problema e un outlier
#Per adesso lavoriamo cosi.</p>
<p>##ANOVA ——————————————-</p>
<p>#Cos’e un ANOVA?
#Per me, scoprire si la varianza tra grouppi e
#piu grande di quella dentro i gruppi</p>
<p>#Lo facciamo in ogni ambiente
mydata_Sestola &lt;- subset(mydata, loc == “Sestola”)
myanova_Sestola &lt;- aov(yield ~ gen, data=mydata_Sestola)
summary(myanova_Sestola)
#PR &gt; 0.05
#Non ci sono dif. significative</p>
<p>mydata_Molise &lt;- subset(mydata, loc == “Molise”)
myanova_Molise &lt;- aov(yield ~ gen, data=mydata_Molise)
summary(myanova_Molise)
#Non ci sono dif. significative</p>
<p>mydata_Rotonda &lt;- subset(mydata, loc == “Rotonda”)
myanova_Rotonda &lt;- aov(yield ~ gen, data=mydata_Rotonda)
summary(myanova_Rotonda)
#no significativo</p>
<p>mydata_Castronuovo &lt;- subset(mydata, loc == “Castronuovo”)
myanova_Castronuovo &lt;- aov(yield ~ gen, data=mydata_Castronuovo)
summary(myanova_Castronuovo)
#significativo</p>
<p>#TUtto quello si confirma graficamente
ggplot(mydata, #la mia tabella
aes(y= gen, #i genotipi
x=yield)) + # resa
geom_boxplot()+ # geometria
facet_wrap(loc~.) #facets</p>
<p>#—————————————————-#
##LSD O HSD —————————————–</p>
<p>#Questi test si chiamano “POST HOC” e permetteno trovare diff. tra gruppi
#Ma solo si l’anova ci da differenze</p>
<p>#Il pacchetto agricolae e fatto a posto per la esperimentaziona agraria
#e ci permette di calculare lo LSD (Least Significant Difference)
#e lo HSD (Honest Significant Difference)
#(Sono molto similari, lo HSD es un po piu nuovo e piu usato)
install.packages(“agricolae”)
library(agricolae)</p>
<p>#Facciamo groups (lettere) per genotipo in Castronuovo
#La funzione e HSD.test()
#Oppure LSD.test()
myHSD_Castronuovo = HSD.test(myanova_Castronuovo, # il mio argumento e il resultado del ANOVA
“gen”) #La mia variabile “Trattamento”
myHSD_Castronuovo</p>
<p>#Il obgeto myHSD_Rotonda ha tanta roba
#La poso vedere con myHSD_Rotonda$
#OCHIO! IN questo caso, $ no chiama colonne, ma tabelle intiere
#Per esempio, consulta la statistica
myHSD_Castronuovo$statistics</p>
<p>#Ci interesa il ogetto che ha i gruppi
myHSD_Castronuovo<span class="math inline">\(groups groups = myHSD_Castronuovo\)</span>groups
groups</p>
<p>#Finalmente, si voglio fare un plot con i letri,
#posso mettere i letri nella tabbella.
#MA! E un pochino tricky.</p>
<p>#(Si e troppo complesso si puo fare oppure in power point)</p>
<p>#Andiamo</p>
<p>#Prima, devo aggiungere il nome del genotipo a la tabella
#(per adesso, sono soltanto i nomi delle rige)
groups = cbind(groups, rownames(groups))
#cbind significa column bind e ci lascia aggiungere colonne
groups
#Ma, il nome de la colonna e brutto.
names(groups)</p>
<p>#Lo cambio
colnames(groups)[3] = “gen”</p>
<p>#Uno la mia tabella de groups con quella degli dati
mydata_Castronuovo &lt;- merge(mydata_Castronuovo, groups[,c(2,3)], by = “gen”)</p>
<p>##Finalmente, il plot.
ggplot(mydata_Castronuovo, #la mia tabella
aes(x= gen, #i genotipi
y=yield)) +
geom_boxplot()+ #geometria box plot
geom_point(col = “tomato”)+ #geometria punti rossi
geom_text(aes(label= groups, #Lettere dei groups!
y= 1000))+ # Posizione della letera iguale per tutti!
labs( x= “Genotipo,”<br />
y= “Resa (kg),”
main= “Rotonda”)+ #Titoli del grafo
theme(text= element_text(size=15)) #Dimensione del testo.</p>
<p>#Prova a esportarlo cliccando sul “export” nella finestra giu a destra</p>
<p>#Fino qui arriva il nostro oggetivo
#Si c’e tempo seguiamo</p>
<p>#E come meto le lettere a canto delle “box?”
#Piu complicatino ma possibile
#Devo indicare la posizione “x” univocamente per ogni genotipo.
#Come ho due dati per genotipo, si lo faccio adesseo avro due lettere.</p>
<p>#Quindi, una opzione e calculare la media per genotipo.</p>
<p>#Ci vuole questo pachetto
install.packages(“dplyr”)
library(dplyr)</p>
<p>Il simbolo %&gt;% se chiama pipeline, e permete saltare de una funzione
a l’altra senza mettere tutti i argomenti.</p>
<p>Castronuovo_summary &lt;- mydata_Castronuovo %&gt;% #la mia tabella
group_by(gen) %&gt;% #la agruppo secondo genotipo
dplyr::summarize(yield_mean = mean(yield), #una colonna e la media
yield_sd = sd(yield), # altra la desviazione standard
groups = unique(groups)) # e altra i gruppi</p>
<p>write.csv(Castronuovo_summary,“datacastronuo.csv”)
?write.csv</p>
<p>metto unique() per i gruppi perche
cosi prende solo un dato per genotipo
e da 18 rigghe paso a 9.</p>
<p>#Finalmente il plot
#Questa volta lo facciamo con i barre per che e anche bellino</p>
<p>ggplot(Castronuovo_summary, #la mia tabella, questa volta ho scelto “Castronuovo Summary”
aes(x= gen, #i genotipi
y=yield_mean)) + #
geom_bar(stat= “identity,” fill = “tomato”) +
geom_errorbar(aes(ymin= yield_mean - yield_sd,
ymax= yield_mean + yield_sd))+ #Il argomente stat= “identity” mi permmette que il asse “y” sea proprio la resa e non il numero de rigghe
geom_text(aes(label= groups, #Lettere dei groups!
y= yield_mean + yield_sd + 40))+ # Posizione della letera (la pos de la barra + 10 uds.)
labs( x= “Genotipo,”<br />
y= “Resa (kg),”
main= “Rotonda”)+ #Titoli del grafo
theme(text= element_text(size=15)) #Dimensione del testo.</p>
<p>Cose sigue?
Special packages!
For next time diGGer, SPATS, GGE BiPLOT, PPB STATS!</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="experimental-design-and-field-preparation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PPB Toolkit.pdf", "PPB Toolkit.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
